<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="æœ¬æ–‡æ˜¯ç»å…¸çš„Functors, Applicatives, And Monads In Picturesçš„Typescriptç¿»è¯‘ç‰ˆæœ¬ã€‚ Functor/Applicative/Monadæ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„ä¸€äº›æ¯”è¾ƒâ€˜åŸºç¡€â€™çš„æ¦‚å¿µï¼Œåæ­£æˆ‘æ˜¯ä¸è®¤åŒâ€˜åŸºç¡€â€™è¿™ä¸ªè¯´æ³•çš„ï¼Œç¬”è€…ä¹Ÿé˜…è¯»è¿‡å¾ˆå¤šç±»ä¼¼ä»‹ç»Monadçš„æ–‡ç« ï¼Œæœ€åéƒ½ä¸äº†äº†ä¹‹ï¼Œè¿™äº›æ¦‚å¿µæ˜¯æ¯”è¾ƒéš¾ä»¥ç†è§£çš„ï¼Œè€Œä¸”å¹³æ—¶ç¼–ç¨‹å®è·µä¸­ä¹Ÿå¾ˆéš¾ä¼šæ¥è§¦åˆ°è¿™äº›ä¸œè¥¿ã€‚ åæ¥æ‹œè¯»äº†">
<meta name="keywords" content="Blog,FrontEnd,React,Javascript,Typescript">
<meta property="og:type" content="article">
<meta property="og:title" content="Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad">
<meta property="og:url" content="https://bobi.ink/2019/08/22/ts-fam/index.html">
<meta property="og:site_name" content="Bobi.ink">
<meta property="og:description" content="æœ¬æ–‡æ˜¯ç»å…¸çš„Functors, Applicatives, And Monads In Picturesçš„Typescriptç¿»è¯‘ç‰ˆæœ¬ã€‚ Functor/Applicative/Monadæ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„ä¸€äº›æ¯”è¾ƒâ€˜åŸºç¡€â€™çš„æ¦‚å¿µï¼Œåæ­£æˆ‘æ˜¯ä¸è®¤åŒâ€˜åŸºç¡€â€™è¿™ä¸ªè¯´æ³•çš„ï¼Œç¬”è€…ä¹Ÿé˜…è¯»è¿‡å¾ˆå¤šç±»ä¼¼ä»‹ç»Monadçš„æ–‡ç« ï¼Œæœ€åéƒ½ä¸äº†äº†ä¹‹ï¼Œè¿™äº›æ¦‚å¿µæ˜¯æ¯”è¾ƒéš¾ä»¥ç†è§£çš„ï¼Œè€Œä¸”å¹³æ—¶ç¼–ç¨‹å®è·µä¸­ä¹Ÿå¾ˆéš¾ä¼šæ¥è§¦åˆ°è¿™äº›ä¸œè¥¿ã€‚ åæ¥æ‹œè¯»äº†">
<meta property="og:locale" content="zh">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/value.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/value_apply.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/value_and_context.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/context.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/no_fmap_ouch.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/fmap_apply.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/functor_def.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/fmap_def.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/fmap_just.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/fmap_nothing.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/bill.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/fmap_list.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/function_with_value.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/fmap_function.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/value_and_context.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/function_and_context.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/applicative_just.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/applicative_list.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/fmap.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/applicative.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/context.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/half.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/half_ouch.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/plunger.jpg">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/bind_def.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/monad_just.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/monad_nothing.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/monad_chain.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/whoa.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/io.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/getLine.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/readFile.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/putStrLn.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/monad_io.png">
<meta property="og:image" content="https://bobi.ink/images/ts-fam/recap.png">
<meta property="og:updated_time" content="2023-06-01T09:55:14.331Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad">
<meta name="twitter:description" content="æœ¬æ–‡æ˜¯ç»å…¸çš„Functors, Applicatives, And Monads In Picturesçš„Typescriptç¿»è¯‘ç‰ˆæœ¬ã€‚ Functor/Applicative/Monadæ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„ä¸€äº›æ¯”è¾ƒâ€˜åŸºç¡€â€™çš„æ¦‚å¿µï¼Œåæ­£æˆ‘æ˜¯ä¸è®¤åŒâ€˜åŸºç¡€â€™è¿™ä¸ªè¯´æ³•çš„ï¼Œç¬”è€…ä¹Ÿé˜…è¯»è¿‡å¾ˆå¤šç±»ä¼¼ä»‹ç»Monadçš„æ–‡ç« ï¼Œæœ€åéƒ½ä¸äº†äº†ä¹‹ï¼Œè¿™äº›æ¦‚å¿µæ˜¯æ¯”è¾ƒéš¾ä»¥ç†è§£çš„ï¼Œè€Œä¸”å¹³æ—¶ç¼–ç¨‹å®è·µä¸­ä¹Ÿå¾ˆéš¾ä¼šæ¥è§¦åˆ°è¿™äº›ä¸œè¥¿ã€‚ åæ¥æ‹œè¯»äº†">
<meta name="twitter:image" content="https://bobi.ink/images/ts-fam/value.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Blogs</a></li>
         
          <li><a href="http://github.com/ivan-94">Projects</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/08/29/js-bs/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/08/10/react-hooks/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://bobi.ink/2019/08/22/ts-fam/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://bobi.ink/2019/08/22/ts-fam/&text=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://bobi.ink/2019/08/22/ts-fam/&title=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://bobi.ink/2019/08/22/ts-fam/&is_video=false&description=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad&body=Check out this article: https://bobi.ink/2019/08/22/ts-fam/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://bobi.ink/2019/08/22/ts-fam/&title=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://bobi.ink/2019/08/22/ts-fam/&title=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://bobi.ink/2019/08/22/ts-fam/&title=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://bobi.ink/2019/08/22/ts-fam/&title=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://bobi.ink/2019/08/22/ts-fam/&name=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#functors"><span class="toc-number">1.</span> <span class="toc-text">Functors</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ç©¶ç«Ÿä»€ä¹ˆæ˜¯-functor-å‘¢ï¼Ÿ"><span class="toc-number">2.</span> <span class="toc-text">ç©¶ç«Ÿä»€ä¹ˆæ˜¯ Functor å‘¢ï¼Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#functoræ€»ç»“"><span class="toc-number">2.1.</span> <span class="toc-text">Functoræ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#applicative"><span class="toc-number">3.</span> <span class="toc-text">Applicative</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#applicativeæ€»ç»“"><span class="toc-number">3.1.</span> <span class="toc-text">Applicativeæ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#monad"><span class="toc-number">4.</span> <span class="toc-text">Monad</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ€»ç»“"><span class="toc-number">5.</span> <span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ‰©å±•"><span class="toc-number">6.</span> <span class="toc-text">æ‰©å±•</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Bobi.ink</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-08-21T16:00:00.000Z" itemprop="datePublished">2019-08-22</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>æœ¬æ–‡æ˜¯ç»å…¸çš„<a href="http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html" target="_blank" rel="noopener">Functors, Applicatives, And Monads In Pictures</a>çš„Typescriptç¿»è¯‘ç‰ˆæœ¬ã€‚</p>
<p>Functor/Applicative/Monadæ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„ä¸€äº›æ¯”è¾ƒâ€˜åŸºç¡€â€™çš„æ¦‚å¿µï¼Œåæ­£æˆ‘æ˜¯ä¸è®¤åŒâ€˜åŸºç¡€â€™è¿™ä¸ªè¯´æ³•çš„ï¼Œç¬”è€…ä¹Ÿé˜…è¯»è¿‡å¾ˆå¤šç±»ä¼¼ä»‹ç»Monadçš„æ–‡ç« ï¼Œæœ€åéƒ½ä¸äº†äº†ä¹‹ï¼Œè¿™äº›æ¦‚å¿µæ˜¯æ¯”è¾ƒéš¾ä»¥ç†è§£çš„ï¼Œè€Œä¸”å¹³æ—¶ç¼–ç¨‹å®è·µä¸­ä¹Ÿå¾ˆéš¾ä¼šæ¥è§¦åˆ°è¿™äº›ä¸œè¥¿ã€‚</p>
<p>åæ¥æ‹œè¯»äº†<a href="http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html" target="_blank" rel="noopener">Functors, Applicatives, And Monads In Pictures</a>, ä¸é”™ï¼Œå¥½åƒæ‡‚äº†ã€‚äºæ˜¯è‡ªå·±æƒ³é€šè¿‡ç¿»è¯‘ï¼Œå†æ·±å…¥æ¶ˆåŒ–æ¶ˆåŒ–è¿™ç¯‡æ–‡ç« ï¼Œè¿™é‡Œä½¿ç”¨<code>Typescript</code>ä½œä¸ºæè¿°è¯­è¨€ï¼Œå¯¹äºå‰ç«¯æ¥è¯´ä¼šæ›´å¥½ç†è§£ã€‚</p>
<p>æœ‰ç†è§£ä¸æ­£ç¡®çš„åœ°æ–¹ï¼Œæ•¬è¯·æŒ‡æ­£. å¼€å§‹å§ï¼</p>
<p><br></p>
<p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å€¼:</p>
<p><img src="/images/ts-fam/value.png" alt></p>
<p>ä¾‹å¦‚è¿™äº›</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>        <span class="comment">// number</span></span><br><span class="line"><span class="string">'string'</span> <span class="comment">// string</span></span><br></pre></td></tr></table></figure>
<p>å¤§å®¶éƒ½çŸ¥é“æ€ä¹ˆå°†ä¸€ä¸ªå‡½æ•°åº”ç”¨åˆ°è¿™ä¸ªå€¼ä¸Šé¢:</p>
<p><img src="/images/ts-fam/value_apply.png" alt></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// So easy</span></span><br><span class="line"><span class="keyword">const</span> add3 = <span class="function">(<span class="params">val: <span class="built_in">number</span></span>) =&gt;</span> val + <span class="number">3</span></span><br><span class="line"><span class="built_in">console</span>.log(add3(<span class="number">2</span>)) <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>
<p>å¾ˆç®€å•äº†. æˆ‘ä»¬æ¥æ‰©å±•ä¸€ä¸‹, è®©ä»»æ„çš„å€¼æ˜¯å¯ä»¥åŒ…è£…åœ¨ä¸€ä¸ª<strong>ä¸Šä¸‹æ–‡(context)</strong>å½“ä¸­. ç°åœ¨çš„æƒ…å†µä½ å¯ä»¥æƒ³è±¡ä¸€ä¸ªå¯ä»¥æŠŠå€¼æ”¾è¿›å»çš„ç›’å­:</p>
<p><img src="/images/ts-fam/value_and_context.png" alt></p>
<p>ç°åœ¨ä½ <strong>æŠŠä¸€ä¸ªå‡½æ•°åº”ç”¨åˆ°è¿™ä¸ªåŒ…è£…å€¼çš„æ—¶å€™, æ ¹æ®å…¶ä¸Šä¸‹æ–‡ç±»å‹ä½ ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœ</strong>. è¿™å°±æ˜¯ <code>Functor</code>, <code>Applicative</code>, <code>Monad</code>, <code>Arrow</code> ä¹‹ç±»æ¦‚å¿µçš„åŸºç¡€. </p>
<p><code>Maybe</code> å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„æ•°æ®ç±»å‹, å®ƒå®šä¹‰äº†ä¸¤ç§ç›¸å…³çš„â€˜<strong>ä¸Šä¸‹æ–‡</strong>â€™, Maybeæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªâ€˜ä¸Šä¸‹æ–‡â€™(é™¤äº†å€¼ï¼Œå…¶ä»–ç±»å‹éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Ÿ):</p>
<p><img src="/images/ts-fam/context.png" alt></p>
<p>åŸæ–‡åŸºäºHaskellï¼Œå®ƒçš„Maybeç±»å‹æœ‰ä¸¤ä¸ªä¸Šä¸‹æ–‡Just(è“è‰²ç›’å­)å’ŒNone(çº¢è‰²ç©ºç›’å­)ã€‚ä»¿é€ Haskellåœ¨Typescriptä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>å¯é€‰ç±»å‹(Maybe)</code>æ¥è¡¨ç¤º:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Maybe&lt;T&gt; = Just&lt;T&gt; | Nothing <span class="comment">// Just è¡¨ç¤ºå€¼â€˜å­˜åœ¨â€™ï¼ŒNothingè¡¨ç¤ºç©ºå€¼ï¼Œç±»ä¼¼äºnullã€undefinedçš„æ¦‚å¿µ</span></span><br></pre></td></tr></table></figure>
<p>Justå’ŒNothingçš„åŸºæœ¬ç»“æ„:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æˆ‘ä»¬åªç”¨Noneæ¥å–ä»£null, è¿™é‡Œæˆ‘ä»¬å°†Noneä½œä¸ºä¸€ä¸ªå€¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç±»</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> None &#123;&#125;</span><br><span class="line"><span class="comment">// å¯¹åº”Noneçš„ç±»å‹</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> Nothing = <span class="keyword">typeof</span> None</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯Nothingï¼Œè¿™é‡Œä½¿ç”¨Typescriptçš„ `Type Guards`</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> isNothing = (val: <span class="built_in">any</span>): val is Nothing =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> val === None</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Justç±»å‹</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> Just&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">static</span> of&lt;T&gt;(val: T) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Just(val)</span><br><span class="line">  &#125;</span><br><span class="line">  value: T</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params">value: T</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.value = value</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ç¤ºä¾‹:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a: Maybe&lt;<span class="built_in">number</span>&gt;;</span><br><span class="line">a = None;</span><br><span class="line">a = Just.of(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¯´å®åœ¨è¿™ä¸ªå®ç°æœ‰ç‚¹æŒ«, ä½†æ˜¯ä¸ºäº†æ›´åŠ è´´è¿‘åŸæ–‡æè¿°ï¼Œæš‚ä¸”ä½¿ç”¨è¿™ä¸ªå®ç°ã€‚ä¹‹å‰è€ƒè™‘è¿‡çš„ä¸€ä¸ªç‰ˆæœ¬æ˜¯ä¸‹é¢è¿™æ ·çš„, å› ä¸ºæ— æ³•ç»™å®ƒä»¬æ‰©å±•æ–¹æ³•ï¼Œå°±æ”¾å¼ƒäº†è¿™ä¸ªæ–¹æ¡ˆ:<br>  <figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Optional&lt;T&gt; = NonNullable&lt;T&gt; | nul</span><br><span class="line"><span class="keyword">let</span> a: Optional&lt;<span class="built_in">number</span>&gt; = <span class="number">1</span>;</span><br><span class="line">a = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><br></p>
<p>å¾ˆå¿«æˆ‘ä»¬ä¼šçœ‹åˆ°å¯¹ä¸€ä¸ª <code>Just&lt;a&gt;</code> å’Œä¸€ä¸ª Nothing æ¥è¯´, å‡½æ•°åº”ç”¨æœ‰ä½•ä¸åŒ. é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹ Functor!</p>
<p><br><br><br></p>
<h2 id="functors"><a href="#functors" class="headerlink" title="Functors"></a>Functors</h2><p>å½“ä¸€ä¸ªå€¼è¢«åŒ…è£…åœ¨ä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­æ—¶, ä½ å°±ä¸èƒ½æ‹¿æ™®é€šå‡½æ•°æ¥åº”ç”¨äº†:</p>
<p><img src="/images/ts-fam/no_fmap_ouch.png" alt></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">let</span> a: Just&lt;<span class="built_in">number</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> add3 = <span class="function">(<span class="params">v: <span class="built_in">number</span></span>) =&gt;</span> v + <span class="number">3</span></span><br><span class="line">add3(a) <span class="comment">// âŒ ç±»å‹â€œJust&lt;number&gt;â€çš„å‚æ•°ä¸èƒ½èµ‹ç»™ç±»å‹â€œnumberâ€çš„å‚</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶å€™, è¯¥ <code>fmap</code> å‡ºåœºäº†. fmap ç¿©ç¿©è€Œæ¥ï¼Œä»å®¹åº”å¯¹ä¸Šä¸‹æ–‡(fmap is from the street, fmap is hip to contexts). è¿˜æœ‰è°? fmap çŸ¥é“æ€æ ·å°†ä¸€ä¸ªå‡½æ•°åº”ç”¨åˆ°ä¸€ä¸ªåŒ…è£…åœ¨ä¸Šä¸‹æ–‡çš„å€¼ä¸Š. <strong>ä½ å¯ä»¥å¯¹ä»»ä½•ä¸€ä¸ªç±»å‹ä¸º Functor çš„ç±»å‹ä½¿ç”¨ fmap</strong>ï¼Œ æ¢å¥è¯è¯´ï¼ŒFunctoréƒ½å®šä¹‰äº†fmap.</p>
<p>æ¯”å¦‚è¯´, æƒ³ä¸€ä¸‹ä½ æƒ³æŠŠ add3 åº”ç”¨åˆ° Just 2. ç”¨ fmap:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">Just.of(<span class="number">2</span>).fmap(add3) <span class="comment">// Just 5</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/ts-fam/fmap_apply.png" alt></p>
<p><strong>ğŸ’¥å˜­ï¼</strong> fmap å‘æˆ‘ä»¬å±•ç¤ºäº†å®ƒçš„æˆæœã€‚ ä½†æ˜¯ fmap æ€ä¹ˆçŸ¥é“å¦‚ä½•åº”ç”¨è¯¥å‡½æ•°çš„å‘¢ï¼Ÿ</p>
<p><br></p>
<h2 id="ç©¶ç«Ÿä»€ä¹ˆæ˜¯-functor-å‘¢ï¼Ÿ"><a href="#ç©¶ç«Ÿä»€ä¹ˆæ˜¯-functor-å‘¢ï¼Ÿ" class="headerlink" title="ç©¶ç«Ÿä»€ä¹ˆæ˜¯ Functor å‘¢ï¼Ÿ"></a>ç©¶ç«Ÿä»€ä¹ˆæ˜¯ Functor å‘¢ï¼Ÿ</h2><p>åœ¨ Haskell ä¸­ <code>Functor</code> æ˜¯ä¸€ä¸ª<a href="http://learnyouahaskell.com/types-and-typeclasses#typeclasses-101" target="_blank" rel="noopener">ç±»å‹ç±»(typeclass)</a>ã€‚ å…¶å®šä¹‰å¦‚ä¸‹ï¼š</p>
<p><img src="/images/ts-fam/functor_def.png" alt></p>
<p>åœ¨Typescriptä¸­ï¼Œ ä¸€ä¸ªFunctorè®¤ä¸ºæ˜¯<strong>å®šä¹‰äº†fmapçš„ä»»æ„ç±»å‹</strong>. çœ‹çœ‹<code>fmap</code>æ˜¯å¦‚ä½•å·¥ä½œçš„:</p>
<p><img src="/images/ts-fam/fmap_def.png" alt></p>
<ol>
<li>ä¸€ä¸ªFunctorç±»å‹çš„ fa, ä¾‹å¦‚Just 2</li>
<li>fa å®šä¹‰äº†ä¸€ä¸ªfmap, fmap æ¥å—ä¸€ä¸ªå‡½æ•°fnï¼Œä¾‹å¦‚add3</li>
<li>fmap ç›´åˆ°å¦‚ä½•å°†faåº”ç”¨åˆ°fnä¸­ï¼Œ è¿”å›ä¸€ä¸ªFunctorç±»å‹çš„ fb. <strong>faå’Œfbçš„åŒ…è£…ä¸Šä¸‹æ–‡ç±»å‹ä¸€æ ·</strong>, ä¾‹å¦‚faæ˜¯Just, é‚£ä¹ˆfbä¹Ÿæ˜¯Just; åä¹‹faæ˜¯Nothingï¼Œfbä¹Ÿæ˜¯Nothing;</li>
</ol>
<p>ç”¨Typescriptçš„å‡½æ•°ç­¾åæè¿°ä¸€ä¸‹ï¼š</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">&lt;Functor T&gt;.fmap&lt;U&gt;<span class="function">(<span class="params">fn: (<span class="params">val: T</span>) =&gt; U</span>): &lt;<span class="params">Functor</span> <span class="params">U</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼š</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">Just.of(<span class="number">2</span>).fmap(add3) <span class="comment">// Just 5</span></span><br></pre></td></tr></table></figure>
<p>è€Œ fmap ç¥å¥‡åœ°åº”ç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œå› ä¸º Maybe æ˜¯ä¸€ä¸ª Functor, å®ƒæŒ‡å®šäº† fmap å¦‚ä½•åº”ç”¨åˆ° Just ä¸Šä¸ Nothing ä¸Š:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> Just&lt;T&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="comment">// å®ç°fmap</span></span><br><span class="line">  fmap&lt;U&gt;<span class="function">(<span class="params">fn: (<span class="params">val: T</span>) =&gt; U</span>) &#123;</span></span><br><span class="line"><span class="function">    <span class="params">return</span> <span class="params">Just</span>.<span class="params">of</span>(<span class="params">fn(<span class="params"><span class="keyword">this</span>.value</span>)</span>)</span></span><br><span class="line"><span class="function">  &#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="params">class</span> <span class="params">None</span> &#123;</span></span><br><span class="line"><span class="function">  // <span class="params">None</span> æ¥å—ä»»ä½•å‡½æ•°éƒ½è¿”å›<span class="params">None</span></span></span><br><span class="line"><span class="function">  <span class="params">static</span> <span class="params">fmap</span>(<span class="params">fn: <span class="built_in">any</span></span>) &#123;</span></span><br><span class="line"><span class="function">    <span class="params">return</span> <span class="params">None</span></span></span><br><span class="line"><span class="function">  &#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p>å½“æˆ‘ä»¬å†™ <code>Just.of(2).fmap(add3)</code> æ—¶ï¼Œè¿™æ˜¯å¹•åå‘ç”Ÿçš„äº‹æƒ…ï¼š</p>
<p><img src="/images/ts-fam/fmap_just.png" alt></p>
<p>é‚£ä¹ˆç„¶åï¼Œå°±åƒè¿™æ ·ï¼Œfmapï¼Œè¯·å°† add3 åº”ç”¨åˆ° Nothing ä¸Šå¦‚ä½•ï¼Ÿ</p>
<p><img src="/images/ts-fam/fmap_nothing.png" alt></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">None.fmap(add3) <span class="comment">// Nothing</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/ts-fam/bill.png" alt></p>
<p>å°±åƒã€Šé»‘å®¢å¸å›½ã€‹ä¸­çš„ Morpheusï¼Œfmap çŸ¥é“éƒ½è¦åšä»€ä¹ˆï¼›å¦‚æœä½ ä» Nothing å¼€å§‹ï¼Œé‚£ä¹ˆä½ ä¼šä»¥ Nothing ç»“æŸï¼ fmap æ˜¯ç¦…ã€‚</p>
<p>ç°åœ¨å®ƒå‘Šè¯‰æˆ‘ä»¬äº† Maybe æ•°æ®ç±»å‹å­˜åœ¨çš„æ„ä¹‰ã€‚ ä¾‹å¦‚ï¼Œè¿™æ˜¯åœ¨ä¸€ä¸ªæ²¡æœ‰ Maybe çš„è¯­è¨€ä¸­å¤„ç†ä¸€ä¸ªæ•°æ®åº“è®°å½•çš„æ–¹å¼, æ¯”å¦‚Javascript:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> post = Post.findByID(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">if</span> (post != <span class="literal">null</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> post.title</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰äº†fmapå:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾findPostè¿”å›Maybe&lt;Article&gt;</span></span><br><span class="line">findPost(<span class="number">1</span>).fmap(getPostTitle)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœ findPost è¿”å›ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°±ä¼šé€šè¿‡ getPostTitle è·å–å…¶æ ‡é¢˜ã€‚ å¦‚æœå®ƒè¿”å› Nothingï¼Œæˆ‘ä»¬å°±ä¹Ÿè¿”å› Nothingï¼ è¾ƒä¹‹å‰ç®€æ´äº†å¾ˆå¤šå¯¹å§?</p>
<blockquote>
<p>Typescriptæœ‰äº†Optional Chainingåï¼Œå¤„ç†nullä¹Ÿå¯ä»¥å¾ˆç®€æ´:<br> <figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">findPost(<span class="number">1</span>)?.title <span class="comment">// å¼‚æ›²åŒå·¥</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>åŸæ–‡è¿˜æœ‰å®šä¹‰äº†ä¸€ä¸ªfmapçš„é‡è½½æ“ä½œç¬¦ç‰ˆæœ¬ï¼Œå› ä¸ºJavaScriptä¸æ”¯æŒæ“ä½œç¬¦é‡è½½ï¼Œæ‰€ä»¥è¿™é‡Œç®€å•å¸¦è¿‡<br> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">getPostTitle &lt;$&gt; findPost(1) // ä½¿ç”¨æ“ä½œç¬¦é‡è½½&lt;$&gt; æ¥ç®€åŒ–fmap. ç­‰ä»·äºä¸Šé¢çš„ä»£ç </span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><br></p>
<p>å†çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼šå¦‚æœå°†ä¸€ä¸ªå‡½æ•°åº”ç”¨åˆ°ä¸€ä¸ª Arrayï¼ˆHaksell ä¸­æ˜¯ Listï¼‰ä¸Šä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<p><img src="/images/ts-fam/fmap_list.png" alt></p>
<p>Array ä¹Ÿæ˜¯ functorï¼</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(add3) <span class="comment">// [4, 5, 6]. faæ˜¯Arrayï¼Œè¾“å‡ºfbä¹Ÿæ˜¯Arrayï¼Œç¬¦åˆFunctorçš„å®šä¹‰å§ï¼Œæ‰€ä»¥Javascriptçš„mapå°±æ˜¯fmapï¼ŒArrayå°±æ˜¯Functor</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p>å¥½äº†ï¼Œå¥½äº†ï¼Œæœ€åä¸€ä¸ªç¤ºä¾‹ï¼šå¦‚æœå°†ä¸€ä¸ªå‡½æ•°åº”ç”¨åˆ°å¦ä¸€ä¸ªå‡½æ•°ä¸Šä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> multiply3 = <span class="function">(<span class="params">v: <span class="built_in">number</span></span>) =&gt;</span> v * <span class="number">3</span></span><br><span class="line"><span class="keyword">const</span> add3 = <span class="function">(<span class="params">v: <span class="built_in">number</span></span>) =&gt;</span> v + <span class="number">3</span></span><br><span class="line"></span><br><span class="line">add3.fmap(multiply3) <span class="comment">// â“</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼š</p>
<p><img src="/images/ts-fam/function_with_value.png" alt></p>
<p>è¿™æ˜¯ä¸€ä¸ªåº”ç”¨åˆ°å¦ä¸€ä¸ªå‡½æ•°ä¸Šçš„å‡½æ•°ï¼š</p>
<p><img src="/images/ts-fam/fmap_function.png" alt></p>
<p>å…¶ç»“æœæ˜¯åˆä¸€ä¸ªå‡½æ•°ï¼</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä»…ä½œç¤ºä¾‹ï¼Œä¸è¦æ¨¡ä»¿</span></span><br><span class="line"><span class="keyword">interface</span> Function &#123;</span><br><span class="line">  fmap&lt;V, T, U&gt;<span class="function">(<span class="params"><span class="keyword">this</span>: (<span class="params">val: V</span>) =&gt; T, fn: (<span class="params">val: T</span>) =&gt; U</span>): (<span class="params">val: V</span>) =&gt;</span> U</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Function</span>.prototype.fmap = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">v</span> =&gt;</span> fn(<span class="keyword">this</span>(v))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥å‡½æ•°ä¹Ÿæ˜¯ Functorï¼ å¯¹ä¸€ä¸ªå‡½æ•°ä½¿ç”¨ fmapï¼Œå…¶å®å°±æ˜¯å‡½æ•°ç»„åˆ(compose)ï¼ ä¹Ÿå°±æ˜¯è¯´: <code>f.fmap(g)</code> ç­‰ä»·äº <code>compose(f, g)</code></p>
<p><br></p>
<h3 id="functoræ€»ç»“"><a href="#functoræ€»ç»“" class="headerlink" title="Functoræ€»ç»“"></a>Functoræ€»ç»“</h3><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œå¯ä»¥çŸ¥é“Functorå…¶å®å¹¶æ²¡æœ‰é‚£ä¹ˆéš¾ä»¥ç†è§£, ä¸€ä¸ªFunctorå°±æ˜¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;Functor T&gt;.fmap(fn: (v: T) =&gt; U): &lt;Functor U&gt;</span><br></pre></td></tr></table></figure>
<p>Functorä¼šå®šä¹‰ä¸€ä¸ªâ€˜fmapâ€™æ“ä½œï¼Œè¿™ä¸ªfmapæ¥å—ä¸€ä¸ªå‡½æ•°fnï¼Œfnæ¥æ”¶çš„æ˜¯å…·ä½“çš„å€¼ï¼Œè¿”å›å¦ä¸€ä¸ªå…·ä½“çš„å€¼ï¼Œä¾‹å¦‚ä¸Šé¢çš„add3. <strong>fmapå†³å®šå¦‚ä½•æ¥åº”ç”¨fnåˆ°æºFunctor(a)</strong>ï¼Œ è¿”å›ä¸€ä¸ªæ–°çš„Functor(b)ã€‚ ä¹Ÿå°±æ˜¯fmapçš„æºå’Œè¾“å‡ºçš„å€¼â€˜ä¸Šä¸‹æ–‡â€™ç±»å‹æ˜¯ä¸€æ ·çš„ã€‚æ¯”å¦‚</p>
<ul>
<li><code>Just -&gt; fmap -&gt; Just</code></li>
<li><code>Nothing -&gt; fmap -&gt; Nothing</code></li>
<li><code>Maybe -&gt; fmap -&gt; Maybe</code></li>
<li><code>Array -&gt; fmap -&gt; Array</code></li>
</ul>
<p><br><br><br></p>
<h2 id="applicative"><a href="#applicative" class="headerlink" title="Applicative"></a>Applicative</h2><p>ç°åœ¨ç»ƒåˆ°äºŒé‡å¤©äº†ã€‚ Applicative åˆæå‡äº†ä¸€ä¸ªå±‚æ¬¡ã€‚</p>
<p>å¯¹äº Applicativeï¼Œæˆ‘ä»¬çš„å€¼ä¾ç„¶å’Œ Functor ä¸€æ ·åŒ…è£…åœ¨ä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­</p>
<p><img src="/images/ts-fam/value_and_context.png" alt></p>
<p>ä¸ä¸€æ ·çš„æ˜¯ï¼Œæˆ‘ä»¬<strong>å°†Functorä¸­çš„å‡½æ•°(ä¾‹å¦‚add3)ä¹ŸåŒ…è£…åœ¨ä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­</strong>ï¼</p>
<p><img src="/images/ts-fam/function_and_context.png" alt></p>
<p>å—¯ã€‚ æˆ‘ä»¬ç»§ç»­æ·±å…¥ã€‚ Applicative å¹¶æ²¡æœ‰å¼€ç©ç¬‘ã€‚ä¸åƒHaskellï¼ŒTypescriptå¹¶æ²¡æœ‰å†…ç½®æ–¹å¼æ¥å¤„ç†Applicativeã€‚æˆ‘ä»¬å¯ä»¥ç»™éœ€è¦æ”¯æŒApplicativeçš„ç±»å‹å®šä¹‰ä¸€ä¸ªapplyå‡½æ•°ã€‚<strong>applyå‡½æ•°çŸ¥é“æ€ä¹ˆå°†<code>åŒ…è£…åœ¨ä¸Šä¸‹æ–‡çš„å‡½æ•°</code>åº”ç”¨åˆ°ä¸€ä¸ª<code>åŒ…è£…åœ¨ä¸Šä¸‹æ–‡çš„å€¼</code></strong>ï¼š</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> None &#123;</span><br><span class="line">  <span class="keyword">static</span> apply(fn: <span class="built_in">any</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> None;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Just&lt;T&gt; &#123;</span><br><span class="line">  <span class="comment">// ä½¿ç”¨æ–¹æ³•é‡è½½ï¼Œè®©Typescriptæ›´å¥½æ¨æ–­</span></span><br><span class="line">  <span class="comment">// å¦‚æœå€¼å’Œå‡½æ•°éƒ½æ˜¯Justç±»å‹ï¼Œç»“æœä¹Ÿæ˜¯Justç±»å‹</span></span><br><span class="line">  apply&lt;U&gt;<span class="function">(<span class="params">fn: Just&lt;(<span class="params">a: T</span>) =&gt; U&gt;</span>): <span class="params">Just</span>&lt;<span class="params">U</span>&gt;;</span></span><br><span class="line"><span class="function">  // å¦‚æœå‡½æ•°æ˜¯<span class="params">Nothing</span>ç±»å‹ï¼Œç»“æœæ˜¯<span class="params">Nothing</span>.</span></span><br><span class="line"><span class="function">  // ä¸¥æ ¼ä¸Š<span class="params">apply</span>åªåº”è¯¥æ¥æ”¶åŒä¸€ä¸ªä¸Šä¸‹æ–‡ç±»å‹çš„å‡½æ•°ï¼Œå³<span class="params">Just</span>,</span></span><br><span class="line"><span class="function">  // å› ä¸º<span class="params">Maybe</span>æ˜¯<span class="params">Typescript</span>çš„<span class="params">Union</span>ç±»å‹ï¼Œæ²¡åŠæ³•ç»™å®ƒæ‰©å±•æ–¹æ³•ï¼Œè¿™é‡Œå°†<span class="params">Maybe</span>å’Œ<span class="params">Just</span>æ··åœ¨ä¸€èµ·äº†</span></span><br><span class="line"><span class="function">  <span class="params">apply</span>&lt;<span class="params">U</span>&gt;(<span class="params">fn: Nothing</span>): <span class="params">Nothing</span>;</span></span><br><span class="line"><span class="function">  // å¦‚æœå€¼å’Œå‡½æ•°éƒ½æ˜¯<span class="params">Maybe</span>ç±»å‹, è¿”å›ä¸€ä¸ª<span class="params">Maybe</span>ç±»å‹</span></span><br><span class="line"><span class="function">  <span class="params">apply</span>&lt;<span class="params">U</span>&gt;(<span class="params">fn: Maybe&lt;(<span class="params">a: T</span>) =&gt; U&gt;</span>): <span class="params">Maybe</span>&lt;<span class="params">U</span>&gt; &#123;</span></span><br><span class="line"><span class="function">    <span class="params">if</span> (<span class="params">!isNothing(<span class="params">fn</span>)</span>) &#123;</span></span><br><span class="line"><span class="function">      <span class="params">return</span> <span class="params">Just</span>.<span class="params">of</span>(<span class="params">fn.value(<span class="params"><span class="keyword">this</span>.value</span>)</span>);</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function">    <span class="params">return</span> <span class="params">None</span>.<span class="params">apply</span>(<span class="params">fn</span>);</span></span><br><span class="line"><span class="function">  &#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p>å†æ¥çœ‹çœ‹æ•°ç»„:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä»…ä½œç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">interface</span> Array&lt;T&gt; &#123;</span><br><span class="line">  apply&lt;U&gt;<span class="function">(<span class="params">fns: <span class="built_in">Array</span>&lt;(<span class="params">e: T</span>) =&gt; U&gt;</span>): <span class="params">U</span>[]</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// æ¥æ”¶ä¸€ä¸ªå‡½æ•°â€˜æ•°ç»„(<span class="params">ä¸Šä¸‹æ–‡</span>)â€™ï¼Œè¿”å›ä¸€ä¸ªåº”ç”¨äº†â€˜å‡½æ•°â€™çš„æ–°çš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="params">Array</span>.<span class="params">prototype</span>.<span class="params">apply</span> = <span class="params">function</span>&lt;<span class="params">T</span>, <span class="params">U</span>&gt;(<span class="params">fns: <span class="built_in">Array</span>&lt;(<span class="params">e: T</span>) =&gt; U&gt;</span>) &#123;</span></span><br><span class="line"><span class="function">  <span class="params">const</span> <span class="params">res</span>: <span class="params">U</span>[] = []</span></span><br><span class="line"><span class="function">  <span class="params">for</span> (<span class="params"><span class="keyword">const</span> fn of fns</span>) &#123;</span></span><br><span class="line"><span class="function">    <span class="params">this</span>.<span class="params">forEach</span>(<span class="params">el =&gt; res.push(<span class="params">fn(<span class="params">el</span>)</span>)</span>)</span></span><br><span class="line"><span class="function">  &#125;</span></span><br><span class="line"><span class="function">  <span class="params">return</span> <span class="params">res</span></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p>åœ¨Haskellä¸­ï¼Œä½¿ç”¨<code>&lt;*&gt;</code>æ¥è¡¨ç¤ºapplyæ“ä½œ: <code>Just (+3) &lt;*&gt; Just 2 == Just 5</code>. Typescriptä¸æ”¯æŒæ“ä½œç¬¦é‡è½½ï¼Œæ‰€ä»¥å¿½ç•¥.</p>
<p>Justç±»å‹çš„Applicativeåº”ç”¨å›¾è§£ï¼š</p>
<p><img src="/images/ts-fam/applicative_just.png" alt></p>
<p>æ•°ç»„ç±»å‹çš„Applicativeåº”ç”¨å›¾è§£ï¼š</p>
<p><img src="/images/ts-fam/applicative_list.png" alt></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> num: <span class="built_in">number</span>[] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="built_in">console</span>.log(num.apply([multiply2, add3]))</span><br><span class="line"><span class="comment">// [2, 4, 6, 4, 5, 6]</span></span><br></pre></td></tr></table></figure>
<p><strong>è¿™é‡Œæœ‰ Applicative èƒ½åšåˆ°è€Œ Functor ä¸èƒ½åšåˆ°çš„äº‹æƒ…</strong>ã€‚ å¦‚ä½•å°†ä¸€ä¸ªæ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°åº”ç”¨åˆ°ä¸¤ä¸ªå·²åŒ…è£…çš„å€¼ä¸Šï¼Ÿ</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸€ä¸ªæ”¯æŒä¸¤ä¸ªå‚æ•°çš„Curryå‹åŠ æ³•å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> curriedAddition = <span class="function">(<span class="params">a: <span class="built_in">number</span></span>) =&gt;</span> (b: <span class="built_in">number</span>) =&gt; a + b</span><br><span class="line"></span><br><span class="line">Just.of(<span class="number">5</span>).fmap(curriedAddition) <span class="comment">// è¿”å› `Just.of((b: number) =&gt; 5 + b)`</span></span><br><span class="line"><span class="comment">// Ok ç»§ç»­</span></span><br><span class="line">Just.of(<span class="number">4</span>).fmap(Just.of(<span class="function">(<span class="params">b: <span class="built_in">number</span></span>) =&gt;</span> <span class="number">5</span> + b))  <span class="comment">// âŒä¸è¡Œäº†ï¼ŒæŠ¥é”™äº†ï¼ŒFunctoræ²¡åŠæ³•å¤„ç†åŒ…è£…åœ¨ä¸Šä¸‹æ–‡çš„fn</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯Applicativeå¯ä»¥ï¼š</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">Just.of(<span class="number">5</span>).fmap(curriedAddition) <span class="comment">// è¿”å› `Just.of((b: number) =&gt; 5 + b)`</span></span><br><span class="line"><span class="comment">// âœ…å½“å½“å½“</span></span><br><span class="line">Just.of(<span class="number">3</span>).apply(Just.of(<span class="function">(<span class="params">b: <span class="built_in">number</span></span>) =&gt;</span> <span class="number">5</span> + b)) <span class="comment">// Just.of(8)</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶å€™Applicative æŠŠ Functor æ¨åˆ°ä¸€è¾¹ã€‚ â€œå¤§äººç‰©å¯ä»¥ä½¿ç”¨å…·æœ‰ä»»æ„æ•°é‡å‚æ•°çš„å‡½æ•°ï¼Œâ€å®ƒè¯´ã€‚ â€œè£…å¤‡äº† &lt;$&gt;(fmap) ä¸ &lt;*&gt;(apply) ä¹‹åï¼Œæˆ‘å¯ä»¥æ¥å—å…·æœ‰ä»»æ„ä¸ªæ•°æœªåŒ…è£…å€¼å‚æ•°çš„ä»»æ„å‡½æ•°ã€‚ ç„¶åæˆ‘ä¼ ç»™å®ƒæ‰€æœ‰å·²åŒ…è£…çš„å€¼ï¼Œè€Œæˆ‘ä¼šå¾—åˆ°ä¸€ä¸ªå·²åŒ…è£…çš„å€¼å‡ºæ¥ï¼ å•Šå•Šå•Šå•Šå•Šï¼â€</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">Just.of(<span class="number">3</span>).apply(Just.of(<span class="number">5</span>).fmap(curriedAddition)) <span class="comment">// è¿”å› `Just.of(8)`</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="applicativeæ€»ç»“"><a href="#applicativeæ€»ç»“" class="headerlink" title="Applicativeæ€»ç»“"></a>Applicativeæ€»ç»“</h3><p>æˆ‘ä»¬é‡ç”³ä¸€ä¸ªApplicativeçš„å®šä¹‰, <strong>å¦‚æœFunctorè¦æ±‚å®ç°fmapçš„è¯ï¼ŒApplicativeå°±æ˜¯è¦æ±‚å®ç°apply</strong>ï¼Œapplyç¬¦åˆä»¥ä¸‹å®šä¹‰:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// è¿™æ˜¯Functorçš„fmapå®šä¹‰</span><br><span class="line">&lt;Functor T&gt;.fmap(fn: (v: T) =&gt; U): &lt;Functor U&gt;</span><br><span class="line"></span><br><span class="line">// è¿™æ˜¯Applicativeçš„applyå®šä¹‰ï¼Œå’Œä¸Šé¢å¯¹æ¯”ï¼Œfnå˜æˆäº†ä¸€ä¸ªåŒ…è£…åœ¨ä¸Šä¸‹æ–‡çš„å‡½æ•°</span><br><span class="line">&lt;Applicative T&gt;.apply(fn: &lt;Applicative (v: T) =&gt; U&gt;): &lt;Applicative U&gt;</span><br></pre></td></tr></table></figure>
<p><br><br><br></p>
<h2 id="monad"><a href="#monad" class="headerlink" title="Monad"></a>Monad</h2><p>ç»ˆäºç»ƒåˆ°ä¸‰é‡å¤©äº†ï¼ç»§ç»­â›½åŠ æ²¹ï¸</p>
<p>å¦‚ä½•å­¦ä¹  Monad å‘¢ï¼š</p>
<ol>
<li>ä½ è¦å–å¾—è®¡ç®—æœºç§‘å­¦åšå£«å­¦ä½ã€‚</li>
<li>ç„¶åæŠŠå®ƒæ‰”æ‰ï¼Œå› ä¸ºåœ¨æœ¬æ–‡ä½ å¹¶ä¸éœ€è¦å®ƒï¼</li>
</ol>
<p>Monad å¢åŠ äº†ä¸€ä¸ªæ–°çš„è½¬å˜ã€‚</p>
<p><code>Functor</code> å°†ä¸€ä¸ª<code>å‡½æ•°</code>åº”ç”¨åˆ°ä¸€ä¸ª<code>å·²åŒ…è£…çš„å€¼</code>ä¸Šï¼š</p>
<p><img src="/images/ts-fam/fmap.png" alt></p>
<p><code>Applicative</code> å°†ä¸€ä¸ª<code>å·²åŒ…è£…çš„å‡½æ•°</code>åº”ç”¨åˆ°ä¸€ä¸ª<code>å·²åŒ…è£…çš„å€¼</code>ä¸Šï¼š</p>
<p><img src="/images/ts-fam/applicative.png" alt></p>
<p>Monad å°†ä¸€ä¸ª<code>è¿”å›å·²åŒ…è£…å€¼çš„å‡½æ•°</code>åº”ç”¨åˆ°ä¸€ä¸ª<code>å·²åŒ…è£…çš„å€¼</code>ä¸Šã€‚ Monad å®šä¹‰ä¸€ä¸ªå‡½æ•°<code>flatMap</code>ï¼ˆåœ¨ Haskell ä¸­æ˜¯ä½¿ç”¨æ“ä½œç¬¦ <code>&gt;&gt;=</code> æ¥åº”ç”¨Monadï¼Œè¯»ä½œâ€œbindâ€ï¼‰æ¥åšè¿™ä¸ªã€‚</p>
<p>è®©æˆ‘ä»¬æ¥çœ‹ä¸ªç¤ºä¾‹ã€‚ è€æ­æ¡£ Maybe æ˜¯ä¸€ä¸ª Monadï¼š</p>
<p><img src="/images/ts-fam/context.png" alt></p>
<p>å‡è®¾ <code>half</code> æ˜¯ä¸€ä¸ªåªé€‚ç”¨äºå¶æ•°çš„å‡½æ•°ï¼š</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿™å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„: "è¿”å›å·²åŒ…è£…å€¼"çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">half</span>(<span class="params">value: <span class="built_in">number</span></span>): <span class="title">Maybe</span>&lt;<span class="title">number</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (value % <span class="number">2</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> Just.of(value / <span class="number">2</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> None</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/ts-fam/half.png" alt></p>
<p>å¦‚æœæˆ‘ä»¬å–‚ç»™å®ƒä¸€ä¸ª<code>å·²åŒ…è£…çš„å€¼</code>ä¼šæ€æ ·ï¼Ÿ</p>
<p><img src="/images/ts-fam/half_ouch.png" alt></p>
<p>æˆ‘ä»¬éœ€è¦ä½¿ç”¨flatMap(Haskell ä¸­çš„&gt;&gt;=)æ¥å°†æˆ‘ä»¬å·²åŒ…è£…çš„å€¼å¡è¿›è¯¥å‡½æ•°ã€‚ è¿™æ˜¯ &gt;&gt;= çš„ç…§ç‰‡ï¼š</p>
<p><img src="/images/ts-fam/plunger.jpg" alt></p>
<p>ä»¥ä¸‹æ˜¯å®ƒçš„å·¥ä½œæ–¹å¼ï¼š</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">Just.of(<span class="number">3</span>).flatMap(half) <span class="comment">// =&gt; Nothing, Haskellä¸­ä½¿ç”¨æ“ä½œç¬¦è¿™æ ·æ“ä½œ: Just 3 &gt;&gt;= half</span></span><br><span class="line">Just.of(<span class="number">4</span>).flatMap(half) <span class="comment">// =&gt; Just 2</span></span><br><span class="line">None.flatMap(half)       <span class="comment">// =&gt; Nothing</span></span><br></pre></td></tr></table></figure>
<p>å†…éƒ¨å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæˆ‘ä»¬å†çœ‹çœ‹flatMapçš„æ–¹æ³•ç­¾å:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Maybe</span></span><br><span class="line">Maybe&lt;T&gt;.flatMap&lt;U&gt;<span class="function">(<span class="params">fn: (<span class="params">val: T</span>) =&gt; Maybe&lt;U&gt;</span>): <span class="params">Maybe</span>&lt;<span class="params">U</span>&gt;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// <span class="params">Array</span></span></span><br><span class="line"><span class="function"><span class="params">Array</span>&lt;<span class="params">T</span>&gt;.<span class="params">flatMap</span>&lt;<span class="params">U</span>&gt;(<span class="params">fn: (<span class="params">val: T</span>) =&gt; U[]</span>): <span class="params">U</span>[]</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/ts-fam/bind_def.png" alt></p>
<p><strong>Arrayæ˜¯ä¸€ä¸ªMonad</strong>, Javascriptçš„Arrayçš„flatMapå·²ç»æ­£å¼æˆä¸ºæ ‡å‡†ï¼Œ çœ‹çœ‹å®ƒçš„ä½¿ç”¨ç¤ºä¾‹:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">arr1.map(<span class="function"><span class="params">x</span> =&gt;</span> [x * <span class="number">2</span>]); </span><br><span class="line"><span class="comment">// [[2], [4], [6], [8]]</span></span><br><span class="line"></span><br><span class="line">arr1.flatMap(<span class="function"><span class="params">x</span> =&gt;</span> [x * <span class="number">2</span>]);</span><br><span class="line"><span class="comment">// [2, 4, 6, 8]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// only one level is flattened</span></span><br><span class="line">arr1.flatMap(<span class="function"><span class="params">x</span> =&gt;</span> [[x * <span class="number">2</span>]]);</span><br><span class="line"><span class="comment">// [[2], [4], [6], [8]]</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<p>Maybe ä¹Ÿæ˜¯ä¸€ä¸ª Monadï¼š</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> None &#123;</span><br><span class="line">  <span class="keyword">static</span> flatMap(fn: <span class="built_in">any</span>): Nothing &#123;</span><br><span class="line">    <span class="keyword">return</span> None;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Just&lt;T&gt; &#123;</span><br><span class="line">  <span class="comment">// å’Œä¸Šé¢çš„applyå·®ä¸å¤š</span></span><br><span class="line">  <span class="comment">// ä½¿ç”¨æ–¹æ³•é‡è½½ï¼Œè®©Typescriptæ›´å¥½æ¨æ–­</span></span><br><span class="line">  <span class="comment">// å¦‚æœå‡½æ•°è¿”å›Justç±»å‹ï¼Œç»“æœä¹Ÿæ˜¯Justç±»å‹</span></span><br><span class="line">  flatMap&lt;U&gt;<span class="function">(<span class="params">fn: (<span class="params">a: T</span>) =&gt; Just&lt;U&gt;</span>): <span class="params">Just</span>&lt;<span class="params">U</span>&gt;;</span></span><br><span class="line"><span class="function">  // å¦‚æœå‡½æ•°è¿”å›å€¼æ˜¯<span class="params">Nothing</span>ç±»å‹ï¼Œç»“æœæ˜¯<span class="params">Nothing</span>.</span></span><br><span class="line"><span class="function">  <span class="params">flatMap</span>&lt;<span class="params">U</span>&gt;(<span class="params">fn: (<span class="params">a: T</span>) =&gt; Nothing</span>): <span class="params">Nothing</span>;</span></span><br><span class="line"><span class="function">  // å¦‚æœå‡½æ•°è¿”å›å€¼æ˜¯<span class="params">Maybe</span>ç±»å‹, è¿”å›ä¸€ä¸ª<span class="params">Maybe</span>ç±»å‹</span></span><br><span class="line"><span class="function">  <span class="params">flatMap</span>&lt;<span class="params">U</span>&gt;(<span class="params">fn: (<span class="params">a: T</span>) =&gt; Maybe&lt;U&gt;</span>): <span class="params">Maybe</span>&lt;<span class="params">U</span>&gt; &#123;</span></span><br><span class="line"><span class="function">    <span class="params">return</span> <span class="params">fn</span>(<span class="params"><span class="keyword">this</span>.value</span>)</span></span><br><span class="line"><span class="function">  &#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// ç¤ºä¾‹</span></span><br><span class="line"><span class="function"><span class="params">Just</span>.<span class="params">of</span>(<span class="params">3</span>).<span class="params">flatMap</span>(<span class="params">half</span>) // <span class="params">Nothing</span></span></span><br><span class="line"><span class="function"><span class="params">Just</span>.<span class="params">of</span>(<span class="params">4</span>).<span class="params">flatMap</span>(<span class="params">half</span>) // <span class="params">Just</span>.<span class="params">of</span>(<span class="params">4</span>)</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯ä¸ Just 3 è¿ä½œçš„æƒ…å†µï¼</p>
<p><img src="/images/ts-fam/monad_just.png" alt></p>
<p>å¦‚æœä¼ å…¥ä¸€ä¸ª Nothing å°±æ›´ç®€å•äº†ï¼š</p>
<p><img src="/images/ts-fam/monad_nothing.png" alt></p>
<p>ä½ è¿˜å¯ä»¥å°†è¿™äº›è°ƒç”¨ä¸²è”èµ·æ¥ï¼š</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">Just.of(<span class="number">20</span>).flatMap(half).flatMap(half).flatMap(falf) <span class="comment">// =&gt; Nothing</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/ts-fam/monad_chain.png" alt><br><img src="/images/ts-fam/whoa.png" alt></p>
<p><br></p>
<p>å¾ˆç‚«é…·å“ˆï¼æ‰€ä»¥æˆ‘ä»¬ç°åœ¨çŸ¥é“Maybeæ—¢æ˜¯ä¸€ä¸ªFunctorã€Applicativeï¼Œè¿˜æ˜¯ä¸€ä¸ªMonadã€‚</p>
<p>åŸæ–‡è¿˜ç¤ºèŒƒäº†å¦ä¸€ä¸ªä¾‹å­: <code>IO</code> Monad, æˆ‘ä»¬è¿™é‡Œå°±ç®€å•äº†è§£ä¸€ä¸‹</p>
<p><img src="/images/ts-fam/io.png" alt></p>
<p>IOçš„ç­¾åå¤§æ¦‚å¦‚ä¸‹:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> IO&lt;T&gt; &#123;</span><br><span class="line">  val: T</span><br><span class="line">  <span class="comment">// å…·ä½“å®ç°æˆ‘ä»¬æš‚ä¸å…³å¿ƒ</span></span><br><span class="line">  flatMap(fn: <span class="function">(<span class="params">val: T</span>) =&gt;</span> IO&lt;U&gt;): IO&lt;U&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…·ä½“æ¥çœ‹ä¸‰ä¸ªå‡½æ•°ã€‚ getLine æ²¡æœ‰å‚æ•°, ç”¨æ¥è·å–ç”¨æˆ·è¾“å…¥ï¼š</p>
<p><img src="/images/ts-fam/getLine.png" alt></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLine</span>(<span class="params"></span>): <span class="title">IO</span>&lt;<span class="title">string</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>readFile æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆæ–‡ä»¶åï¼‰å¹¶è¿”å›è¯¥æ–‡ä»¶çš„å†…å®¹ï¼š</p>
<p><img src="/images/ts-fam/readFile.png" alt></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readFile</span>(<span class="params">filename: <span class="built_in">string</span></span>): <span class="title">IO</span>&lt;<span class="title">string</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>putStrLn è¾“å‡ºå­—ç¬¦ä¸²åˆ°æ§åˆ¶å°ï¼š</p>
<p><img src="/images/ts-fam/putStrLn.png" alt></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">putStrLn</span>(<span class="params">str: <span class="built_in">string</span></span>): <span class="title">IO</span>&lt;<span class="title">void</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ‰€æœ‰è¿™ä¸‰ä¸ªå‡½æ•°éƒ½æ¥å—æ™®é€šå€¼ï¼ˆæˆ–æ— å€¼ï¼‰å¹¶è¿”å›ä¸€ä¸ªå·²åŒ…è£…çš„å€¼ï¼Œå³IOã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ flatMap å°†å®ƒä»¬ä¸²è”èµ·æ¥ï¼</p>
<p><img src="/images/ts-fam/monad_io.png" alt></p>
<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line">getLine().flatMap(readFile).flatMap(putStrLn)</span><br></pre></td></tr></table></figure>
<p>å¤ªæ£’äº†ï¼ å‰æ’å åº§æ¥çœ‹ monad å±•ç¤ºï¼æˆ‘ä»¬ä¸éœ€è¦åœ¨å–æ¶ˆåŒ…è£…å’Œé‡æ–°åŒ…è£… IO monad çš„å€¼ä¸Šæµªè´¹æ—¶é—´. flatMap ä¸ºæˆ‘ä»¬åšäº†é‚£äº›å·¥ä½œ!</p>
<p>Haskell è¿˜ä¸º monad æä¾›äº†è¯­æ³•ç³–, å«åš do è¡¨è¾¾å¼:</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">foo</span> = <span class="keyword">do</span></span><br><span class="line">    filename &lt;- getLine</span><br><span class="line">    contents &lt;- readFile filename</span><br><span class="line">    putStrLn contents</span><br></pre></td></tr></table></figure>
<p><br></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>functor æ˜¯å®ç°äº† <code>fmap</code> çš„æ•°æ®ç±»å‹ã€‚</li>
<li>applicative æ˜¯å®ç°äº† <code>apply</code> çš„æ•°æ®ç±»å‹ã€‚</li>
<li>monad æ˜¯å®ç°äº† <code>flatMap</code> çš„æ•°æ®ç±»å‹ã€‚</li>
<li>Maybe å®ç°äº†è¿™ä¸‰è€…ï¼Œæ‰€ä»¥å®ƒæ˜¯ functorã€ applicativeã€ ä»¥åŠ monadã€‚</li>
</ol>
<p>è¿™ä¸‰è€…æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p>
<p><img src="/images/ts-fam/recap.png" alt></p>
<ol>
<li><strong>functor</strong>: å¯é€šè¿‡ fmap å°†ä¸€ä¸ª<code>å‡½æ•°</code>åº”ç”¨åˆ°ä¸€ä¸ª<code>å·²åŒ…è£…çš„å€¼</code>ä¸Šã€‚</li>
<li><strong>applicative</strong>: å¯é€šè¿‡ apply å°†ä¸€ä¸ª<code>å·²åŒ…è£…çš„å‡½æ•°</code>åº”ç”¨åˆ°<code>å·²åŒ…è£…çš„å€¼</code>ä¸Šã€‚</li>
<li><strong>monad</strong>: å¯é€šè¿‡ flatMap å°†ä¸€ä¸ª<code>è¿”å›å·²åŒ…è£…å€¼çš„å‡½æ•°</code>åº”ç”¨åˆ°<code>å·²åŒ…è£…çš„å€¼</code>ä¸Šã€‚</li>
</ol>
<p>ç»¼åˆèµ·æ¥çœ‹çœ‹å®ƒä»¬çš„ç­¾åï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// è¿™æ˜¯Functorçš„fmapå®šä¹‰</span><br><span class="line">&lt;Functor T&gt;.fmap(fn: (v: T) =&gt; U): &lt;Functor U&gt;</span><br><span class="line"></span><br><span class="line">// è¿™æ˜¯Applicativeçš„applyå®šä¹‰ï¼Œå’Œä¸Šé¢å¯¹æ¯”ï¼Œfnå˜æˆäº†ä¸€ä¸ªåŒ…è£…åœ¨ä¸Šä¸‹æ–‡çš„å‡½æ•°</span><br><span class="line">&lt;Applicative T&gt;.apply(fn: &lt;Applicative (v: T) =&gt; U&gt;): &lt;Applicative U&gt;</span><br><span class="line"></span><br><span class="line">// Monadçš„å®šä¹‰, è€Œæ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œ è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªåŒ…è£…åœ¨ä¸Šä¸‹æ–‡çš„å€¼</span><br><span class="line">&lt;Monad T&gt;.flatmap(fn: (v: T) =&gt; &lt;Monad U&gt;): &lt;Monad U&gt;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œäº²çˆ±çš„æœ‹å‹ï¼ˆæˆ‘è§‰å¾—æˆ‘ä»¬ç°åœ¨æ˜¯æœ‹å‹äº†ï¼‰ï¼Œæˆ‘æƒ³æˆ‘ä»¬éƒ½åŒæ„ monad æ˜¯ä¸€ä¸ªç®€å•ä¸”é«˜æ˜çš„ä¸»æ„ï¼ˆSMART IDEA(tm)ï¼‰ã€‚ ç°åœ¨ä½ å·²ç»é€šè¿‡è¿™ç¯‡æŒ‡å—æ¶¦æ¹¿äº†ä½ çš„å£å“¨ï¼Œä¸ºä»€ä¹ˆä¸æ‹‰ä¸Š Mel Gibson å¹¶æŠ“ä½æ•´ä¸ªç“¶å­å‘¢ã€‚ å‚é˜…ã€ŠHaskell è¶£å­¦æŒ‡å—ã€‹çš„ã€Šæ¥çœ‹çœ‹å‡ ç§ Monadã€‹ã€‚ å¾ˆå¤šä¸œè¥¿æˆ‘å…¶å®æ©é¥°äº†å› ä¸º Miran æ·±å…¥è¿™æ–¹é¢åšå¾—å¾ˆæ£’.</p>
<p><br></p>
<h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><p>æœ¬æ–‡åœ¨<a href="http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html" target="_blank" rel="noopener">åŸæ–‡</a>çš„åŸºç¡€ä¸Š, å‚è€ƒäº†ä¸‹åˆ—è¿™äº›ç¿»è¯‘ç‰ˆæœ¬ï¼Œå†æ¬¡æ„Ÿè°¢è¿™äº›ä½œè€…:</p>
<ul>
<li><a href="http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html#translations" target="_blank" rel="noopener">Functors, Applicatives, And Monads In Pictures</a> - åŸæ–‡</li>
<li><a href="http://www.mokacoding.com/blog/functor-applicative-monads-in-pictures/" target="_blank" rel="noopener">Swift Functors, Applicatives, and Monads in Pictures</a> - Swiftç‰ˆæœ¬, æœ¬æ–‡ä¸»è¦å‚è€ƒè¿™ç¯‡æ–‡ç« </li>
<li><a href="https://hltj.me/kotlin/2017/08/25/kotlin-functor-applicative-monad-cn.html" target="_blank" rel="noopener">Kotlin ç‰ˆå›¾è§£ Functorã€Applicative ä¸ Monad</a> - Kotlinç‰ˆæœ¬ï¼Œç¿»è¯‘éå¸¸æ£’</li>
<li><a href="http://jiyinyiyong.github.io/monads-in-pictures/" target="_blank" rel="noopener">Functor, Applicative, ä»¥åŠ Monad çš„å›¾ç‰‡é˜é‡Š</a> - ä¸­æ–‡ç‰ˆæœ¬ï¼Œ<strong>é¢˜å¶</strong>ç¿»è¯‘</li>
<li><a href="https://medium.com/@lettier/your-easy-guide-to-monads-applicatives-functors-862048d61610" target="_blank" rel="noopener">Your easy guide to Monads, Applicatives, &amp; Functors</a> - Mediumä¸Šä¸€ç¯‡åŠ¨å›¾å›¾è§£Monadçš„æ–‡ç« ï¼Œå†™å¾—ä¹Ÿä¸é”™. è¯»å®Œæœ¬æ–‡å¯ä»¥å†è¯»è¿™ç¯‡æ–‡ç« </li>
</ul>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Blogs</a></li>
         
          <li><a href="http://github.com/ivan-94">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#functors"><span class="toc-number">1.</span> <span class="toc-text">Functors</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ç©¶ç«Ÿä»€ä¹ˆæ˜¯-functor-å‘¢ï¼Ÿ"><span class="toc-number">2.</span> <span class="toc-text">ç©¶ç«Ÿä»€ä¹ˆæ˜¯ Functor å‘¢ï¼Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#functoræ€»ç»“"><span class="toc-number">2.1.</span> <span class="toc-text">Functoræ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#applicative"><span class="toc-number">3.</span> <span class="toc-text">Applicative</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#applicativeæ€»ç»“"><span class="toc-number">3.1.</span> <span class="toc-text">Applicativeæ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#monad"><span class="toc-number">4.</span> <span class="toc-text">Monad</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ€»ç»“"><span class="toc-number">5.</span> <span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ‰©å±•"><span class="toc-number">6.</span> <span class="toc-text">æ‰©å±•</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://bobi.ink/2019/08/22/ts-fam/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://bobi.ink/2019/08/22/ts-fam/&text=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://bobi.ink/2019/08/22/ts-fam/&title=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://bobi.ink/2019/08/22/ts-fam/&is_video=false&description=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad&body=Check out this article: https://bobi.ink/2019/08/22/ts-fam/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://bobi.ink/2019/08/22/ts-fam/&title=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://bobi.ink/2019/08/22/ts-fam/&title=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://bobi.ink/2019/08/22/ts-fam/&title=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://bobi.ink/2019/08/22/ts-fam/&title=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://bobi.ink/2019/08/22/ts-fam/&name=Typescriptç‰ˆå›¾è§£Functor , Applicative å’Œ Monad&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2023 Ivan
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Blogs</a></li>
         
          <li><a href="http://github.com/ivan-94">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>


    <!-- Google Analytics -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-44571525-2', 'auto');
        ga('send', 'pageview');
    </script>


    <!-- Disqus Comments -->
    <script type="text/javascript">
        var disqus_shortname = 'bobi-ink';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


