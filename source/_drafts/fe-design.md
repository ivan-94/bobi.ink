---
title: "if 我是前端团队 Leader，怎么做好软件设计文档"
date: 2019/7/15
categories: 前端
---

[if 我是前端团队 Leader，怎么制定前端协作规范?](https://juejin.im/post/5d3a7134f265da1b5d57f1ed)在掘金目前已经突破740个赞了，这篇文章是前者延展。继续介绍我在前端团队管理方面的思考和探索。

传统软件开发有一个软件设计阶段，在开工之前将能确定的确定下来，把该考虑的考虑了。这相比在开发阶段发现问题，解决的成本要低很多。

按照教科书上的定义，软件设计就是**是一个将需求转变为软件陈述（表达）的过程**。一般有概要设计(或者初步设计， Preliminary design)和详细设计(Detail design). 概要设计将需求转换成数据和软件框架，而详细设计将框架逐步求精细化为具体的数据结构和软件的算法表达。

对于前端而言，’软件设计‘很少被提及，也有可能是前端的工作，比较简单，所以比较粗放。给了原型和接口文档就直接开干了。但是虽然前端开发者的工作越来越复杂，或者项目/团队的规模变大，我们越来越需要合理的设计。

TODO: 痛点背景介绍

总结一下为什么我开始重视软件设计阶段:

- 事前. 设计文档是开发阶段的蓝图，后续开发都是按照这个文档逐步展开
  - 我们在设计阶段会进一步梳理业务流程，加深对业务流程的理解，甚至可以找出业务流程中的不合理的东西。
  - 模块拆分。这个阶段我们会识别各个模块之间边界和重叠，将重叠的(共享的)部分抽离出来。另外模块是基本的开发工作单元，也是我们团队分工和时间评估的基础。
  - 考察关键的技术点。提出多种备选方案，充分考虑各种风险
- 事后. 设计文档对事后的软件维护、功能新增，有很大的帮助

下面开始介绍，前端在**软件设计阶段**应该做什么东西，或者说前端的`设计文档`里面应该包含哪些东西. 当然这些只是一些初步的想法，随着后面深入实践后，本文会持续更新迭代.

<!-- TOC -->

- [关键业务流程的梳理](#关键业务流程的梳理)
- [关键技术点](#关键技术点)
- [模块设计](#模块设计)
  - [入口层](#入口层)
  - [页面层](#页面层)
  - [组件层](#组件层)
  - [分工](#分工)
- [状态设计](#状态设计)
- [接口设计](#接口设计)
- [版本规划](#版本规划)
- [验证](#验证)
- [明确项目要求](#明确项目要求)
- [文档索引](#文档索引)
- [构建说明](#构建说明)
- [模板](#模板)

<!-- /TOC -->

<br>

## 关键业务流程的梳理

开发任何一个产品之前，首先要确保的是对业务流程的理解，否则就会出现南辕北辙的情况。

在现实项目开发中发生过多次这类情况：项目到达测试阶段，测试人员才发现应用的业务实现和产品定义不一样，或者业务流程不合理。
这其实是一种很低级的失误，成本很高，甚至会让你的所有工作白干。

![](/images/fe-design/doc.png)

管理比较成熟的公司会有很多手段来规避这种失误。比如定义明确需求文档，这方面可以模仿一些标准/规范(Spec)的写作方法，严格定义一些关键字，避免模棱两可的描述. 另外可以通过各种宣贯会议，将相关人员聚集在一起，统一导入需求。在这些会议中可以进行头脑风暴，优化或细化需求的定义、发现缺陷和风险，分析可行性等等。通过不断沟通，成员之间可以分享交叉知识，确保对业务一致性理解.

因此，我觉得**前端在设计阶段也应该像后端一样，用流程图或者时序图这类工具，将关键业务流程描述清楚. 尤其是涉及到前后端, 跨系统/跨页面/跨终端之间的业务交互的场景**.

举个例子，比如我们在做一个’扫码登录‘功能。我们可以将跨终端的业务梳理出来：

![](/images/fe-design/scan-login.png)

从流程图中我们可以识别出业务对象的基本行为和状态. 例如二维码的状态转换图:

![](/images/fe-design/scan-login-state.png)

当然, 简单的增删查改花篇幅去阐述没有意义。我们只关注应用关键的业务流程.

总之，业务流程的梳理，可以加深我们对业务的理解，方面我们后续的设计和实现，减少沟通成本。另外也有利于事后项目的维护和迭代，比如新成员接手项目后，完善的文档可以帮助其快速理解项目。

<br>
<br>

## 关键技术点

描述应用采用的或者涉及到关键技术/算法等等, 这个可以认为是**技术选型**. 比较典型的有视频直播应用，涉及到的各种直播方案:

- RTMP 协议
- RTP协议
- HLS 协议
- flv.js
- WebRTC协议
- 等等

在开启一个项目之前, 我们需要对项目涉及到的关键技术点进行调研和测试，最好多找几个替代方案，横向地比较它们的优势和劣势。选择符合项目或团队自己情况的方案. 如果时间充足, 可以写一些Demo，实地踩一下坑.

提前做好技术的调研和选型，确定可行性，不至于开发处于被动的境地.

关于如何进行技术选型，我在[if 我是前端团队 Leader，怎么制定前端协作规范?](https://juejin.im/post/5d3a7134f265da1b5d57f1ed#heading-10)进行了简单的讨论，可以参考一下.

<br>
<br>

## 模块设计

目前前端一般都使用组件化思维进行开发，这时候我们的应用其实就是一颗由不同粒度的组件复合起来的组件树。在设计阶段我们可以根据产品原型或UI设计稿，识别出各种页面和组件。

正常的应用，我们可以分三个层级进行拆分:

![](/images/fe-design/module.png)

### 入口层

稍微复杂一点的应用可能有多个入口，这些入口呈现的页面可能差异很大. 下面是一个常见的划分方法:

- 按子系统划分: 比如前台和后台。
- 按角色划分：比如管理员、普通用户
- 按入口划分：比如移动端、桌面端等等

<br>

### 页面层

下一步就是识别各种页面，这些页面即对应到我们的前端路由配置规则. 以下面简单的应用为例:

![](/images/fe-design/sample-pages.png)

关于模块的划分，我建议使用**思维导图**进行组织。关于模块划分这个环节，你可以召集团队的其他成员开个会议，一起进行头脑风暴。大家参照着产品原型，识别出各种模块或组件的边界和交集, 讨论怎么设置页面的数据流、组件的接口等等。

上面的应用通过页面层划分后，结果大概如下：

![](/images/fe-design/pages.png)

在这里阶段我们会确定以下内容:

- **页面以及路由设计, 确定页面之间的层级关系**
- **页面之间交互流程、数据传递**

关于路由设计，可以遵循一些规范，笔者比较推荐[Restful URL规范](http://www.ruanyifeng.com/blog/2018/10/restful-api-best-practices.html), 这篇[文章](https://novoland.github.io/设计/2015/08/17/Restful%20API%20的设计规范.html)写得也不错.

关于路由之间的数据传递一般有以下几种:

- 少量数据：可以通过路由变量(例如`/posts/:id`)或者查询字符串形式传递. 还有如果你使用的是[基于History API的前端路由模式](https://react-router.docschina.org/web/api/BrowserRouter)，可以使用History的[state](https://developer.mozilla.org/zh-CN/docs/Web/API/History_API#pushState()_方法)对象来存储一些状态(最大640k)
- 大量数据：可以通过全局变量，或者状态管理器的机制进行存储, 不管这种存储在内存的方式，一旦页面刷新就会丢失。所以也可以考虑存储在本地缓存中, 例如LocalStorage

<br>

### 组件层

Ok，再往下拆分，不过要量力而行。对于一个非常复杂的项目来说，可能有成千上百个组件，而且这些组件在未来可能会不断变化，在设计阶段考虑这些拆分可能需要花费很多时间，而且收益并不明显。

那么需要怎么把握粒度呢？其实组件层设计阶段的主要目的是**找出重复的、或者结构类似的组件，将它们抽取出来统一的设计，在多个页面进行复用. 并不是把所有的组件都列举出来**。

我在[React组件设计实践总结02 - 组件的组织](https://juejin.im/post/5cd8fb916fb9a03218556fc1)这篇文章中，专门介绍React组件如何进行组织和拆分。其中提出了以下集中模式:

- 容器组件和展示组件分离。或者说分离视图和逻辑, 业务组件和傻瓜组件
- 纯组件和非纯组件. 可以认为纯组件完全依赖外部输入
- 有状态组件和无状态组件
- 布局组件和内容组件
- 统一设计同一类型组件的接口. 比如表单组件应该保持接口统一

![](/images/fe-design/sample-pages2.png)

上面的示例应用，申报页面有非常多的表单项，而且经常变动，另外你会发现它和预览页面的结构是差不多的，而且后面可能会有桌面端页面。经过讨论，我们绝对采用配置文件的方式来动态渲染这些表单和预览项。实现一套配置控制移动端申请表单、桌面端申请表单、移动端预览、桌面端预览页面。

类似这种应用场景，前期的组件层设计就很有必要了。

![](/images/fe-design/components.png)

<br>

### 分工

组件界别

找出可复用的组件
找到模块之间的依赖关系
划分优先级

分工方式

头脑风暴，脑图

## 状态设计

## 接口设计

确定接口协议标准

## 版本规划

根据优先级， 时间点，任务分割，阶段性任务

## 验证

除了测试提供的测试用例，还需要注意哪些功能， 怎么验证它的有效性
风险评估
异常情况考虑

## 明确项目要求

兼容性
运行环境
时间点
性能指标要求

## 文档索引

需求文档
Demo
测试用例
接口文档
设计规范文档
前端规范文档

## 构建说明

开发说明和构建说明

## 模板